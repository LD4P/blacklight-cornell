<%= form_tag catalog_index_path, :class => 'advanced', :method => :get do  %>
  <%#= search_as_hidden_fields(:params => advanced_search_context ) %>
  <div class="query_column span12">
    <div class="input_row">
      <label for="q" class="hide-text"><%= t('blacklight.search.form.q') %></label>

      <%= text_field_tag "q_row[]", params[:q], :placeholder => t('blacklight.search.form.q'), :id => "q", :autocapitalize => "off" %>

      <%= select_tag("op_row[]", options_for_select({'all'=>'AND','any'=>'OR', 'phrase' => 'phrase'}.sort,'all'), :class => 'input-small') %> in

      <%= select_tag("search_field_row[]", options_for_select(search_fields_for_advanced_search.collect{|key, field_def| [field_def.label, field_def.field]}, :selected => params[:search_field]), :id => 'search_field_advanced', :class => 'advanced-search-field') %>
    </div>

    <%= render :partial => 'advanced_search_rows' %>
  </div>

  <a href="#" id="add-row"><i class="icon-plus-sign"></i> Add a row</a>

  <%# # Comment out the display of active constraints -- still need to be removed
      # from the query before it's sent to Solr. John will handle this in the
      # controller.
  %>
  <%# unless (search_context_str = render_search_to_s( advanced_search_context)).blank? %>
    <%# <div class="constraints">
      <h4>Within search:</h4> %>
      <%#= search_context_str %>
    <%# </div> %>
  <%# end %>

  <div class="sort_submit_buttons clearfix">
    <%= label_tag(:sort, "Sort results by") %>

    <%= select_tag(:sort, options_for_select(sort_fields, h(params[:sort]))) %>

    <%= hidden_field_tag(:search_field, blacklight_config.advanced_search[:url_key]) %>

    <%= submit_tag 'Search', :class=>'btn btn-inverse', :id=>'advanced_search' %>
  </div>
<% end %>


